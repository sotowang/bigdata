**作者：索罗娃·多卡纳 链接：<https://www.nowcoder.com/discuss/203984> 来源：牛客网**

# 一面  

## cookie和session的区别  

* cookie 在客户端
* session在服务端
* 通过cookie实现session

## session的生命周期  

* session调用 inValidate
* session到期,maxAge=-1

## 有n个服务器，怎样去协调他们使用redis

分布式锁

set key value px ... nx 

## redis持久化方式  

* RDB
* AOF
* RDB-AOF(官方推荐)

## Mysql索引结构  

* B树
* B+树
* Hash

## Mysql查询优化  

## 最左匹配原则

例子  有ABCD，建立了index(A,C,D)  

查A = xx and D = xx可以吗  

查C = xx and D = xx可以吗  

查C = xx and A = xx可以吗

## 算法

给定数组nums=[1,2,3,2,3,5,4],和一个常数K，找到有没有可能将nums分成k个子集，使得每个子集的和相等  (5),(1,4),(2,3),(2,3) 

# 二面

https://www.nowcoder.com/discuss/210068

## HTTPS和HTTP的区别  

* SSL加密,更安全
* 端口80与443
* https需要到ca申请证书,一般收费
* HTTP为明文传输

## java GC分为哪几种  

* Minor GC
* Full GC

## TCP/UDP区别  

* 面向连接VS无连接
* 大量数据VS少量数据
* 可靠(三次握手,段标号)VS不可靠
* 慢VS快

## TCP连接建立的过程  

* 三次握手

## 要是服务器发送的最后一个报文时，客户端挂了会怎样  

A B C D 建立了A，C，D三个索引  ,A = x and C = x 用到了几个索引  

* 一次查询只能用到一个索引

## 算法题

求最长不重复子序列  

# 三面

## 堆排序实现

## Inoodb与MyISM的区别

* 行级锁与表级锁
* 支持事务
* 索引

## TCP的TIMED_WAITING  

* 保证最后一个ACK报文到达B
* 防止失效的报文连接请求

## 如何写一个多线程  

* 继承Thread(实现了Runnable接口)
* 实现Runanable(推荐)
* 实现Callable
* 线程池

## 线程池有哪几个组件  

* 线程池管理器
* 工作线程
* 任务接口
* 任务队列



---

https://www.nowcoder.com/discuss/167644 

# 一面 

## 算法

* 找出数组中只出现一次的那个数，其他都出现两次；(异或) 

* 接上面，如果数组中有两个数只出现一次呢？（懵...纸上划了划，还好几分钟后突然灵光一现） 

## 悲观锁和乐观锁 

* 悲观锁
  * 适用于多写,如数据库 行锁,表锁,写锁等
  * ReentrantLock,Synchronized锁
* 乐观锁
  * 适用于多读
  * CAS算法
    * ABA问题(AtomicStampedReference类解决)
    * 长时间循环造成性能开销大
    * 只适用于单个共享变量(JDK1.5之后的AtomicReference解决)
  * 版本号机制
    * 通过对比Version  确定是否更新

## 讲讲你知道的锁

* 悲观锁
* 乐观锁
* 公平锁
* 非公平锁
* 可重入锁
* 分段锁

## ReentrantLock实现原理

* 实现前提为AQS
  * CountDownLatch,FurureTask,Semaphore,Renentrantlock是该抽象类的子类
  * 围绕state变量提供获取和释放
  * tryAcquire获取锁
    * state=0.表示锁无人占有
    * 再判断队列前是否有线程在等待锁,.没有的话调用compareAndSetState使用CAS修改state,传入的acquires写死是1
    * 获取锁成功后,将线程记录为独占锁的线程
    * 线程可以不停lock增加state值(可重入),对应地也要unlock
  * 锁获取失败后加入等待队列(addWaiter),队列节点为Node对象,维护前后Node和指针和等待状态
  * 释放锁
    * 头节点是获取锁的线程,先移除头节点,再通知后面的节点获取锁(sync.release(1))

## 讲讲AQS怎么实现的Fair和NoFair； 

* FairSync
  * 重写tryAcquire方法,参数为1
  * hasQueuePredecessors()保证公平性
  * 只有在队列为空或者当前线程已获得锁(重入)的情况下,才能获得锁
* NonfairSync
  * 若state==0,获得锁
  * 当前线程为拥有锁的线程,获得锁

##  ssh是什么原理？（RSA非对称加密，生成一个公钥和一个私钥） 

## 项目用到了redis，讲讲你项目用到了redis的哪些特性； 

## redis的单进程单线程模型； 

## 延伸到IO多路复用； 

## 一路延伸到epoll、poll、select(主要讲了三者使用的数据结构区别以及各自的特点)； 

## 再次手撕代码，BST中任意两个节点差的最小值；（题应该算简单的，一紧张脑子就不好用了，磨蹭了会儿才搞出来）； 

## 序列化； 

## 看到简历上有写zookeeper，zookeeper怎么保证数据一致性的； 

## 简历上面有个项目是自己做的一个小轮子，问应用场景； 



# 二面 

 	0. 自我介绍； 

		1. redis支持哪些数据类型； 
		
		2. redis中的字符串类型是怎么实现的；(SDS) 
		
		3. SDS相比原生的char[]有什么优点；（共有4个优点，前不久刚看过，当时只回忆起1个优点。。） 
		
		4. 关于redis对象系统的一个问题；（我说忘记了，记得redis设计与实现有写，面试小哥：忘记了那就不问了） 
		
		5. cookie、session、token三者区别以及优缺点（熟悉归熟悉，突然很懵，说得不全，我说我组织一下语言，面试小哥：别组织了，干脆我问你吧） 
		
		6. 讲讲一致性hash，然后套路了一波虚拟节点； 
		
		7. git rebase实现原理（我说没用过，不是很熟悉，只讲了个大概，面试小哥：那跳过吧） 
		
		8. 简历上作死写了不熟悉的Go语言，那讲讲你对Go的理解吧（我直说学过一段时间，但是不熟悉，然后讲了自己对Go感受比较深的一个特性，协程）； 
		
		9. 撕个代码放松放松，判断二叉树是否中心对称（我来了个深呼吸，面试小哥：别紧张，放轻松）； 
		
		10. 继续放松，大数相乘；（劈里啪啦一顿敲，面试小哥好像没见过我这种大数相乘的算法？？） 
		
		11. 面试小哥：好了，等下一面吧:) 
		
		又忐忑不安的等了大概半小时（？？），终于，等到了面试官向你发起面试邀请，然后一阵阵卡顿，退出、重登，又是一阵卡顿，如是三番，面试官留言：网络太卡，我联系HR给你换一个面试官，看会不会好点。。 
		
		又是一阵紧张的等待，抓紧时间复习以前写的题。。。 

# 三面开始（40min）： 

 	0. 自我介绍 

		1. 上来就是一个堆排序，面试大哥：5分钟写完吧，然后关了语音和视频不知干嘛去了； 
		
		隐约记得堆排，一阵敲，5min过去，有个数组越界的bug没搞定，有点慌，不知过去多久，面试大哥回来。。 
		
		我：大致是这样，不过有个小问题还没搞定，数组越界了。。 
		
		面试大哥：你觉得出现问题的在哪行？ 
		
		我：指了下xx和xx行.. 
		
		面试大哥：为什么会越界呢？ 
		
		沉思，我：不应该啊，我判断了越界条件啊.. 
		
		无果，面试大哥：可能是牛客的问题吧，这个先不管了。 
		
		事后查看，是我把子节点用2k和2k+1计算，但是数组还是从0开始（当时脑子真是懵了）。。 
		
		2. 讲讲项目 
		
		3. 项目用到了netty，问了netty相关的一个问题，具体是什么忘了。。 
		
		4. 然后又是select、epoll；（详细讲了一遍） 
		
		5. 项目用到了protostuff序列化库，很多面试官都以为是Google的protobuf，然后就讲讲它们的区别 :) 
		
		6. 项目用到了zookeeper，讲讲你对zk的理解吧；（主要讲了zk的数据模型和watch机制，zab记得不牢不敢讲） 
		
		7. 你对什么感兴趣？（我说了中间件和分布式） 
		
		8. 你能实习多长时间？ 
		
		9. 你意向的工作城市，北京还是上海？ 
		
		10. 最后，介绍了自己的部门，然后说：恭喜你，你过了！ 
		
		第一次得到面试的肯定，感受到丝丝兴奋~ 
		
		总结：最近几场面试下来感受最深的就是，面试需要充分的准备以及运气。 
		
		充分准备不用说，之前在面经里频繁看到select、poll、epoll，也看过一些博客，但每次还是一知半解，前些天下定决心非要把这几个函数调用弄懂，花了一两天时间，阅读了很多博客（有些文章质量真是堪忧，估计作者也没真搞懂，还copy来copy去）以及书籍（Unix网络编程卷一第四五六章，讲得真的是好），甚至还找来源码读了一遍，才终于有底气可以讲清楚这三个函数。 
		
		还有就是运气，今天三次面试的面试官都很nice，比较match自己的风格，所以运气还不错。有时候面试不成功，并不是你的实力不行，真的是面试官和你不够match，当然，这是建立在你准备充分的基础上。 
		
		祝各位都有一个好offer！